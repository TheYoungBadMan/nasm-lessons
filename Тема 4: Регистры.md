### **Регистры процессора**  

Регистры — это небольшие, но очень быстрые ячейки памяти внутри процессора, предназначенные для хранения промежуточных данных и управления выполнением инструкций.
В архитектуре x86-64 регистры размера 64 бита.

```
┌────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐
│00000000|00000000|00000000|00000000|00000000|00000000|00000000|00000000|
├────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│                                  RAX                                  │ 64 бита
└────────┴────────┴────────┴────────┼────────┼────────┼────────┼────────┤
                                    │                EAX                │ 32 бита
                                    └────────┴────────┼────────┼────────┤
                                                      │       AX        │ 16 бит
                                                      ├────────┼────────┤
                                                      │   AH   |   AL   │ 8 бит
                                                      └────────┴────────┘
```    

---
## **1. Регистры общего назначения (GPR — General Purpose Registers)**  
Используются для хранения данных, адресов и промежуточных результатов вычислений. В архитектуре x86-64 есть 16 таких регистров:

#### **64-битные (x86-64) / 32-битные (x86) регистры**  
| 64-битный | 32-битный | 16-битный | 8-битный | 📌 Название (англ.) | Назначение |
|-----------|-----------|-----------|-----------|------------------|----------------------|
| RAX       | EAX       | AX        | AH / AL   | Accumulator      | Аккумулятор (результаты умножения, деления, вызовы `syscall`) |
| RBX       | EBX       | BX        | BH / BL   | Base             | База ( может использоваться как указатель на данные,адреса, смещения) |
| RCX       | ECX       | CX        | CH / CL   | Counter          | Счётчик (циклы, сдвиги, операциях `rep`, `loop`) |
| RDX       | EDX       | DX        | DH / DL   | Data             | Доп. регистр ( умножение, деление, I/O) |
| RSI       | ESI       | SI        | SIL       | Source Index     | Индекс источника (копирование, используется в операциях с памятью, `movs`, `stos`) |
| RDI       | EDI       | DI        | DIL       | Destination Index| Индекс назначения (копирование, используется в операциях с памятью, `movs`, `stos`) |
| RBP       | EBP       | BP        | BPL       | Base Pointer     | Базовый указатель (указывает на фрейм текущей функции) |
| RSP       | ESP       | SP        | SPL       | Stack Pointer    | Указатель стека (указывает на вершину стека)|
| R8 - R15        | R8D - R15D       | R8W - R15W       | R8B - R15B       | General Purpose  | Дополнительный регистр общего назначения в x86-64|


☑ **Разделение регистров по размеру**:  
- 64-битные (`RAX`–`R15`)  
- 32-битные (`EAX`–`R15D`)  
- 16-битные (`AX`–`R15W`)  
- 8-битные (`AL`, `AH`, `R8B`–`R15B`) Можно обращаться к младшим байтам: `AL` (младший байт `AX`), `AH` (старший байт `AX`).

---

## **2. Регистры флагов (FLAGS / EFLAGS / RFLAGS)**
Хранят информацию о состоянии процессора и результата последней операции (инструкций).


```
┌────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐
│00000000|00000000|00000000|00000000|00000000|00000000|00000000|00000000│  
├────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│                                RFLAGS                                 │  64 бита  
└────────┴────────┴────────┴────────┼────────┼────────┼────────┼────────┤
                                    │              EFLAGS               │  32 бита  
                                    └────────┴────────┬────────┬────────┤
                                                      │      FLAGS      │  16 бит  
                                                      ├─┬─┬─┬─┬─┬─┬─┬─┬─┤
                                                      │ OF │ DF │   ... |  (Флаги по битам)  
                                                      └────┴────┴───┴───┘  
```

Здесь:  
- **RFLAGS (64 бита)** — полный 64-битный регистр флагов.  
- **EFLAGS (32 бита)** — младшие 32 бита регистра, используемые в x86.  
- **FLAGS (16 бит)** — младшие 16 бит, доступные в 16-битном режиме.  
- Каждый бит регистра содержит важный флаг.


| Бит  | Флаг  | Название (англ.)         | Описание |
|------|------|--------------------------|----------------------------------------------------------------|
| 0    | CF   | Carry Flag               | Флаг переноса (устанавливается при переполнении в сложении или заёме в вычитании). |
| 1    |      | Reserved (always 1)      | Зарезервировано, всегда равно 1. |
| 2    | PF   | Parity Flag               | Флаг чётности (устанавливается, если число установленных битов в младшем байте результата чётное). |
| 3    |      | Reserved                  | Зарезервировано, всегда равно 0. |
| 4    | AF   | Auxiliary Carry Flag      | Вспомогательный флаг переноса (используется в двоично-десятичной арифметике). |
| 5    |      | Reserved                  | Зарезервировано, всегда равно 0. |
| 6    | ZF   | Zero Flag                 | Флаг нуля (устанавливается, если результат операции равен 0). |
| 7    | SF   | Sign Flag                 | Флаг знака (копирует старший бит результата: 0 — положительное, 1 — отрицательное число). |
| 8    | TF   | Trap Flag                 | Флаг трассировки (при установке вызывает пошаговое выполнение инструкций). |
| 9    | IF   | Interrupt Enable Flag     | Флаг разрешения прерываний (1 — разрешены, 0 — запрещены). |
| 10   | DF   | Direction Flag            | Флаг направления (0 — автоинкремент, 1 — автодекремент при строковых операциях). |
| 11   | OF   | Overflow Flag             | Флаг переполнения (устанавливается, если результат арифметической операции не помещается в разрядную сетку). |
| 12–13| IOPL | I/O Privilege Level       | Уровень привилегий для операций ввода/вывода (используется в защищённом режиме). |
| 14   | NT   | Nested Task Flag          | Флаг вложенных задач (используется для управления многозадачностью). |
| 15   |      | Reserved                  | Зарезервировано, всегда 0. |
| 16   | RF   | Resume Flag               | Флаг возобновления (используется для отладки, подавляет отладочные прерывания). |
| 17   | VM   | Virtual 8086 Mode         | Флаг виртуального режима (1 — процессор работает в режиме Virtual 8086). |
| 18   | AC   | Alignment Check           | Флаг проверки выравнивания (контролирует доступ к данным по заданному выравниванию). |
| 19   | VIF  | Virtual Interrupt Flag    | Виртуальный флаг разрешения прерываний (используется в виртуализации). |
| 20   | VIP  | Virtual Interrupt Pending | Флаг ожидания виртуального прерывания (указывает на отложенное прерывание). |
| 21   | ID   | Identification Flag       | Флаг идентификации (можно изменять для проверки поддержки CPUID). |
| 22–63|      | Reserved                  | Остальные биты зарезервированы и не используются. |

Флаги активно используются в условных переходах, отладке и управлении процессором.

☑ Флаги используются для управления условными переходами (`cmp`, `test`, `jmp`, `je`, `jne` и др.).

Пример работы с флагами:  
```assembly
cmp rax, rbx  ; Устанавливает ZF, SF, CF
jg label      ; Переход, если больше (ZF=0, SF=CF)
```


---

## **3. Регистры для работы с числами с плавающей точкой**
Используются в сопроцессоре FPU (x87) и SIMD-инструкциях (SSE, AVX).

### **3.1. FPU-регистры (x87)**
- Стек из **8 регистров** (`ST0` – `ST7`), работающий по принципу LIFO.
- Применяются для вычислений с плавающей точкой (`fld`, `fadd`, `fmul` и т. д.).
- Управляются через `FPU Control Word`.

Пример:  
```assembly
fld pi     ; Загрузить число π в ST(0)
fmul st, st  ; Умножить π на само себя
fstp result  ; Сохранить результат
```


### **3.2. Регистры SSE (XMM0 – XMM15)**
- Хранят **128-битные векторы** (используются в SSE, SSE2, SSE3, SSE4).
- Могут хранить **4 числа float (32-бит) или 2 числа double (64-бит)**.

### **3.3. Регистры AVX (YMM0 – YMM15)**
- **256-битные** (включают XMM-регистр как младшую часть).
- Могут хранить **8 float или 4 double**.

### **3.4. Регистры AVX-512 (ZMM0 – ZMM31)**
- **512-битные** (расширение YMM).
- Могут хранить **16 float или 8 double**.

#### **SSE / AVX (SIMD-регистры)**  
| Регистры | Битность | 📌 Назначение |
|----------|---------|----------------------|
| XMM0–XMM15 | 128 бит | SSE (Single Instruction, Multiple Data) |
| YMM0–YMM15 | 256 бит | AVX (Advanced Vector Extensions) |
| ZMM0–ZMM31 | 512 бит | AVX-512 (расширенные векторные вычисления) |

Пример использования SSE:  
```assembly
movaps xmm0, [a]   ; Загрузить 4 числа в xmm0
addps xmm0, [b]    ; Сложить 4 числа разом
movaps [c], xmm0   ; Сохранить результат
```

Эти регистры ускоряют векторные вычисления, полезны для графики, физики и ИИ.

---

## **Вывод**
- **GPR** — универсальные регистры для хранения данных и адресов.
- **FLAGS** — содержат информацию о результатах вычислений и управляют процессором.
- **FPU/SIMD-регистры** — предназначены для работы с числами с плавающей точкой и векторных вычислений.

Использование регистров позволяет существенно ускорять вычисления за счёт работы в пределах процессора без обращения к оперативной памяти.
